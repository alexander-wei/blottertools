

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>blottertools documentation &mdash; blottertools  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="blottercli module" href="blottercli.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            blottertools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="blottercli.html">blottercli module</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">functions module</a></li>
<li class="toctree-l1"><a class="reference internal" href="blottertools.html">blottertools package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">blottertools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">blottertools documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="blottertools-documentation">
<h1>blottertools documentation<a class="headerlink" href="#blottertools-documentation" title="Link to this heading"></a></h1>
<section id="blottertools">
<h2>blottertools<a class="headerlink" href="#blottertools" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://alexander-wei.github.io/blottertools/"><img alt="Static Badge" src="https://img.shields.io/badge/docs-html-6082B6?style=for-the-badge" /></a>
 <a class="reference external" href="https://github.com/alexander-wei/blottertools"><img alt="Static Badge" src="https://img.shields.io/badge/github-src-8A9A5B?style=for-the-badge&amp;logo=github" /></a></p>
<p>A small library and CLI for composing Pandas ETL task functions involving a DataFrame. The included CLI demonstrates transforming a CSV input using a sequence of transformation steps.</p>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Library <code class="docutils literal notranslate"><span class="pre">blottertools</span></code> provides lightweight building blocks to implement ETL operations as Python functions and run them in a sequential pipeline.</p></li>
<li><p>CLI <code class="docutils literal notranslate"><span class="pre">blottercli</span></code> is provided as an example entry point that reads a CSV, runs a pipeline, and writes a CSV output.</p></li>
</ul>
</section>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Python 3.12 or newer</p></li>
<li><p>See pyproject.toml for pinned dependencies; notable ones:</p>
<ul>
<li><p>pandas ~= 2.3</p></li>
<li><p>tabulate</p></li>
<li><p>tzdata</p></li>
<li><p>dotenv, Jinja2</p></li>
</ul>
</li>
</ul>
<p>Recommended: use a virtual environment and install dependencies with pip.</p>
</section>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h3>
<p>From the project root:</p>
<ol class="arabic" start="0">
<li><p>Install Python 3.12 or newer. Using <a class="reference external" href="https://www.anaconda.com/download">Anaconda</a>,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>conda create --name [env-name] python=3.12
</pre></div>
</div>
</li>
<li><p>Create and activate a virtual environment (recommended),</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python -m venv .venv
source .venv/bin/activate
</pre></div>
</div>
</li>
<li><p>Install the package,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python -m pip install .
</pre></div>
</div>
</li>
</ol>
<p>This installs a console script named <code class="docutils literal notranslate"><span class="pre">blottercli</span></code>.</p>
</section>
<section id="cli-usage">
<h3>CLI Usage<a class="headerlink" href="#cli-usage" title="Link to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>blottercli path/to/input.csv -o path/to/output.csv

Options:

- input (positional): path to input CSV file (required).
- -o, --output_path: output CSV path. If omitted, the tool writes `blotter-new.csv` into the current working directory.
- --disable-eager: run in non-eager mode (transformations operate on copies and return updated DataFrames).

Example:

blottercli fixtures/sample.csv -o blotter-new.csv
</pre></div>
</div>
</section>
<section id="output">
<h3>Output<a class="headerlink" href="#output" title="Link to this heading"></a></h3>
<p>The CLI expects a CSV containing the columns</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lkid, date, analyst, sector, pal, exposure, ticker
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">ticker</span></code> is omitted, it is ignored.</p>
<p>On execution, the CLI writes a CSV containing the columns:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lkid, date, analyst, sector, pal, exposure, return
</pre></div>
</div>
</section>
<section id="high-level-api-overview">
<h3>High-level API (overview)<a class="headerlink" href="#high-level-api-overview" title="Link to this heading"></a></h3>
<p>The library provides a few simple moving parts to compose ETL logic as reusable functions.</p>
<ul>
<li><p>Pipeline</p>
<ul class="simple">
<li><p>Constructed with an ordered sequence of transformation functions (“steps”).</p></li>
<li><p>Usage: Pipeline(steps).run(executor)</p></li>
<li><p>Each step is a callable that accepts (df, executor, _eager=bool) and returns or mutates a DataFrame.</p></li>
</ul>
</li>
<li><p>PandasExecutor</p>
<ul class="simple">
<li><p>An in-memory executor backed by a pandas.DataFrame.</p></li>
<li><p>Construct with PandasExecutor(df, run_eagerly=True|False).</p></li>
<li><p>Key methods/properties:</p>
<ul>
<li><p>executor.df: the retained DataFrame</p></li>
<li><p>executor.groupby(…): an adapter to pandas’ DataFrame.groupby method</p></li>
</ul>
</li>
</ul>
</li>
<li><p>df_task decorator</p>
<ul>
<li><p>Use &#64;df_task to adapt a transformation function to the pipeline’s expected signature.</p></li>
<li><p>Typical decorated function signature:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@df_task
def my_step(df: pandas.DataFrame, _executor: Optional[Executor] = None) -&gt; pandas.DataFrame:
    # mutate df and return df, or return a new DataFrame
    return df
</pre></div>
</div>
</li>
<li><p>Behavior:</p>
<ul class="simple">
<li><p>If run in eager mode, the decorated function receives the actual DataFrame and must mutate it in place (and must not rebind/return a different DataFrame). If it returns a different object while eager is enabled, a runtime error is raised.</p></li>
<li><p>If not eager, the decorator passes a copy of the DataFrame; the function may return a new DataFrame which will then be assigned back to the executor.</p></li>
<li><p>If your function needs grouped reduction or access to executor-level helpers, accept the optional <code class="docutils literal notranslate"><span class="pre">_executor</span></code> parameter. This is so that a future release may support distributed execution of &#64;df_task, for minimizing active memory consumption.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Writing a pipeline</p>
<ul class="simple">
<li><p>Define a list of step callables (functions decorated with &#64;df_task or compatible with the Transformation protocol).</p></li>
<li><p>Construct a Pipeline and run it with a PandasExecutor.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  from blottertools.adapters import Pipeline, PandasExecutor
  from functions import step1_create_pk, step2_sector_pal_date

  steps = [step1_create_pk, step2_sector_pal_date]
  pipeline = Pipeline(steps)

  df = pandas.read_csv(&quot;input.csv&quot;)
  executor = PandasExecutor(df, run_eagerly=True)
  pipeline.run(executor)
</pre></div>
</div>
<p>The resulting DataFrame is accessed at <code class="docutils literal notranslate"><span class="pre">executor.df</span></code></p>
</li>
</ul>
</section>
<section id="development-running-locally">
<h3>Development / Running locally<a class="headerlink" href="#development-running-locally" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Install with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> and run <code class="docutils literal notranslate"><span class="pre">blottercli</span></code> as shown above.</p></li>
</ul>
</section>
</section>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="blottercli.html">blottercli module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="blottercli.html#blottercli.BlotterCLI"><code class="docutils literal notranslate"><span class="pre">BlotterCLI</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="blottercli.html#blottercli.InvalidInputPathError"><code class="docutils literal notranslate"><span class="pre">InvalidInputPathError</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="blottercli.html#blottercli.PandasReadCSVArgs"><code class="docutils literal notranslate"><span class="pre">PandasReadCSVArgs</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="blottercli.html#blottercli.get_default_output_path"><code class="docutils literal notranslate"><span class="pre">get_default_output_path()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">functions module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.PandasAxisType"><code class="docutils literal notranslate"><span class="pre">PandasAxisType</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.first_alphabetical"><code class="docutils literal notranslate"><span class="pre">first_alphabetical()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.get_first_index_label"><code class="docutils literal notranslate"><span class="pre">get_first_index_label()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.impute_first_day_open_liq"><code class="docutils literal notranslate"><span class="pre">impute_first_day_open_liq()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.impute_ticker_symbol"><code class="docutils literal notranslate"><span class="pre">impute_ticker_symbol()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.step1_create_pk"><code class="docutils literal notranslate"><span class="pre">step1_create_pk()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.step2_sector_pal_date"><code class="docutils literal notranslate"><span class="pre">step2_sector_pal_date()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.step3_impute_ticker"><code class="docutils literal notranslate"><span class="pre">step3_impute_ticker()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.step4_compute_open_liq"><code class="docutils literal notranslate"><span class="pre">step4_compute_open_liq()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.step5_compute_fund_value"><code class="docutils literal notranslate"><span class="pre">step5_compute_fund_value()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#functions.step6_agg_daily"><code class="docutils literal notranslate"><span class="pre">step6_agg_daily()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="blottertools.html">blottertools package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="blottertools.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="blottertools.html#module-blottertools.adapters">blottertools.adapters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="blottertools.html#module-blottertools.decorators">blottertools.decorators module</a></li>
<li class="toctree-l2"><a class="reference internal" href="blottertools.html#module-blottertools">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="blottercli.html" class="btn btn-neutral float-right" title="blottercli module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>